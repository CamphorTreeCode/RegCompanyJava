<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.woman.dao.BusinessCompanyMapper">
	<resultMap id="BaseResultMap" type="com.woman.pojo.BusinessCompany">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		<id column="businessCompanyId" property="businessCompanyId" jdbcType="INTEGER" />
		<result column="businessCompanyContent" property="businessCompanyContent" jdbcType="LONGVARCHAR" />
		<result column="businessCompanyName" property="businessCompanyName" jdbcType="VARCHAR" />
		<result column="businessCompanyCapital" property="businessCompanyCapital" jdbcType="FLOAT" />
		<result column="businessCompanyNumber" property="businessCompanyNumber" jdbcType="LONGVARCHAR" />
		<result column="businessCompanyPayTaxes" property="businessCompanyPayTaxes" jdbcType="INTEGER" />
		<result column="businessCompanyCreatDate" property="businessCompanyCreatDate" jdbcType="VARCHAR" />
	    <result column="businessCompanyRange" property="businessCompanyRange" jdbcType="VARCHAR" />
		<result column="businessCompanyRegion" property="businessCompanyRegion" jdbcType="VARCHAR" />
		<result column="businessCompanyIndustry" property="businessCompanyIndustry" jdbcType="VARCHAR" />
		<result column="businessCompanyAccount" property="businessCompanyAccount" jdbcType="INTEGER" />
		<result column="businessCompanyTax" property="businessCompanyTax" jdbcType="INTEGER" />
		<result column="businessCompanyState" property="businessCompanyState" jdbcType="INTEGER" />
		<result column="businessCompanyCreatTime" property="businessCompanyCreatTime" jdbcType="VARCHAR" />
		<result column="businessCompanyBrowse" property="businessCompanyBrowse" jdbcType="INTEGER" />
		<result column="businessCompany" property="businessCompany" jdbcType="INTEGER" />
		<result column="adminId" property="adminId" jdbcType="INTEGER" />
		<result column="businessCompanyTop" property="businessCompanyTop" jdbcType="INTEGER" />

 	   <association  property="Admin" javaType="com.woman.pojo.Admin">  
        <id column="adminId" property="adminId" jdbcType="INTEGER" />
		<result column="adminName" property="adminName" jdbcType="VARCHAR" />
		<result column="adminPassword" property="adminPassword" jdbcType="VARCHAR" />
		<result column="adminCrateTime" property="adminCrateTime" jdbcType="VARCHAR" />
	    <result column="adminImgUrl" property="adminImgUrl" jdbcType="VARCHAR" />
		<result column="adminNickName" property="adminNickName" jdbcType="VARCHAR" />
		<result column="adminPhone" property="adminPhone" jdbcType="VARCHAR" />	
		<result column="adminAction" property="adminAction" jdbcType="VARCHAR" />
		<result column="adminState" property="adminState" jdbcType="INTEGER" />
		</association >  

	<collection  property="companyImg" javaType="java.util.List"  ofType="com.woman.pojo.CompanyImg" column="businessCompanyId" select="com.woman.dao.CompanyImgMapper.selectCompanyImgAll">  

        <id column="companyImgId" property="companyImgId" jdbcType="INTEGER" />
		<result column="companyUrl" property="companyUrl" jdbcType="VARCHAR" />
		<result column="companyCreatTime" property="companyCreatTime" jdbcType="VARCHAR" />
		<result column="businessCompanyId" property="businessCompanyId" jdbcType="INTEGER" />
		</collection >  

	</resultMap>	
	<!-- 后台用的resultMap 为了级联查询 start -->
	<resultMap id="BaseResultMap1" type="com.woman.pojo.BusinessCompany">
		<id column="businessCompanyId" property="businessCompanyId" jdbcType="INTEGER" />
		<result column="businessCompanyContent" property="businessCompanyContent" jdbcType="LONGVARCHAR" />
		<result column="businessCompanyName" property="businessCompanyName" jdbcType="VARCHAR" />
		<result column="businessCompanyCapital" property="businessCompanyCapital" jdbcType="FLOAT" />
		<result column="businessCompanyNumber" property="businessCompanyNumber" jdbcType="LONGVARCHAR" />
		<result column="businessCompanyPayTaxes" property="businessCompanyPayTaxes" jdbcType="INTEGER" />
		<result column="businessCompanyCreatDate" property="businessCompanyCreatDate" jdbcType="VARCHAR" />
	    <result column="businessCompanyRange" property="businessCompanyRange" jdbcType="VARCHAR" />
		<result column="businessCompanyRegion" property="businessCompanyRegion" jdbcType="VARCHAR" />
		<result column="businessCompanyIndustry" property="businessCompanyIndustry" jdbcType="VARCHAR" />
		<result column="businessCompanyAccount" property="businessCompanyAccount" jdbcType="INTEGER" />
		<result column="businessCompanyTax" property="businessCompanyTax" jdbcType="INTEGER" />
		<result column="businessCompanyState" property="businessCompanyState" jdbcType="INTEGER" />
		<result column="businessCompanyCreatTime" property="businessCompanyCreatTime" jdbcType="VARCHAR" />
		<result column="businessCompanyBrowse" property="businessCompanyBrowse" jdbcType="INTEGER" />
		<result column="businessCompany" property="businessCompany" jdbcType="INTEGER" />
		<result column="adminId" property="adminId" jdbcType="INTEGER" />
		<result column="businessCompanyTop" property="businessCompanyTop" jdbcType="INTEGER" />
 	    <association  property="Admin" column="adminId" select="getAdmin">  
        </association>  		
	   <collection  property="companyImg" column="businessCompanyId" select="getCompanyImg" >  
	     <id column="companyImgId" property="companyImgId" jdbcType="INTEGER" />
	     <result column="companyUrl" property="companyUrl" jdbcType="VARCHAR" />
	     <result column="companyCreatTime" property="companyCreatTime" jdbcType="VARCHAR" />
		 <result column="businessCompanyId" property="businessCompanyId" jdbcType="INTEGER" />
	   </collection >  
  
	</resultMap>
	<!-- 后台用的resultMap 为了级联查询 end -->	
	<!-- 级联查询得到轮播图  -->
	<select id="getCompanyImg" resultType="com.woman.pojo.CompanyImg">
	     select * from CompanyImg where businessCompanyId=#{businessCompanyId}
	</select>
	<!-- 级联查询得到admin -->
	<select id="getAdmin" resultType="com.woman.pojo.Admin">
	    select * from admin where adminId=#{adminId}
	</select>
	
    <!-- 根据状态分页查询  -->
	<select id="getByBusinessCompany" resultMap="BaseResultMap1">
	    select * from BusinessCompany
	    where 1=1


		<if test="businessCompany!=null">
			and businessCompany=#{businessCompany}
		</if> 
		
		<if test='adminState != "0"'>
			and adminId=#{adminId}
		</if>
		order by businessCompanyCreatTime desc
		<if test="start!=null and size!=null">
			LIMIT #{start},#{size}
		</if>
	</select>
	<!-- 根据状态查询一类的总数 -->
	<select id="SelectCount" resultType="Integer">
	 select count(*) from BusinessCompany where businessCompany=#{businessCompany}
	    <if test='adminState == "1"'>
			and adminId=#{adminId}
		</if>
    </select>
		<!-- 查询总记录数 -->
   <select id="selectCount" resultType="Integer" parameterType="Integer">
	select count(businessCompanyId) from BusinessCompany where 1=1
	</select>
	    <!-- 分页查询 -->
	<select id="findByPage" resultMap="BaseResultMap">
	select * from  BusinessCompany bc left join admin a  on bc.adminId = a.adminId WHERE 1=1  
	 <if test="businessCompanyRegion!=null">
	 and bc.businessCompanyRegion LIKE "%"#{businessCompanyRegion}"%"
	 </if>
 	 <if test="businessCompany!=null">
	 and bc.businessCompany = #{businessCompany}
	 </if>
	 <if test="businessCompanyPayTaxes!=null">
	 and bc.businessCompanyPayTaxes = #{businessCompanyPayTaxes}
	 </if>
     <if test="businessCompanyAccount!=null">
	 and bc.businessCompanyAccount = #{businessCompanyAccount}
	 </if>
	 <if test="businessCompanyIndustry">
	 and bc.businessCompanyIndustry = #{businessCompanyIndustry}
	 </if>	  	 
	 order by bc.businessCompanyTop desc , bc.businessCompanyCreatTime desc 
	<if test="start!=null and size!=null">
			LIMIT #{start},#{size}
		</if>

	</select>
	<!-- 插入一条记录 -->
	<insert id="insertbusinessCompany" parameterType="com.woman.pojo.BusinessCompany"
		useGeneratedKeys="true" keyProperty="businessCompanyId">
	     insert into BusinessCompany values(null,#{businessCompanyContent},#{businessCompanyName},#{businessCompanyCapital},
	     #{businessCompanyNumber},#{businessCompanyPayTaxes},#{businessCompanyCreatDate},
	     #{businessCompanyRange},#{businessCompanyRegion},#{businessCompanyIndustry},
	     #{businessCompanyAccount},#{businessCompanyTax},#{businessCompanyState},
	     #{businessCompanyCreatTime},#{businessCompanyBrowse},#{businessCompany},
	     #{adminId},#{businessCompanyTop})
	</insert>
	<!-- 修改一条记录 -->
	<update id="updatebusinessCompany">
	    update BusinessCompany
	    <set>
			<if test="businessCompanyContent != null">
				businessCompanyContent = #{businessCompanyContent,jdbcType=VARCHAR},
			</if>
			<if test="businessCompanyName != null">
				businessCompanyName = #{businessCompanyName,jdbcType=VARCHAR},
			</if>
		
			<if test="businessCompanyCapital != null">
				businessCompanyCapital = #{businessCompanyCapital,jdbcType=FLOAT},
			</if>
			<if test="businessCompanyNumber != null">
				businessCompanyNumber = #{businessCompanyNumber,jdbcType=VARCHAR},
			</if>
			<if test="businessCompanyPayTaxes != null">
				businessCompanyPayTaxes = #{businessCompanyPayTaxes,jdbcType=INTEGER},
			</if>
			<if test="businessCompanyCreatDate != null">
				businessCompanyCreatDate = #{businessCompanyCreatDate,jdbcType=VARCHAR},
			</if>
			<if test="businessCompanyRange != null">
				businessCompanyRange = #{businessCompanyRange,jdbcType=VARCHAR},
			</if>
			<if test="businessCompanyRegion != null">
				businessCompanyRegion = #{businessCompanyRegion,jdbcType=VARCHAR},
			</if>
			<if test="businessCompanyIndustry != null">
				businessCompanyIndustry = #{businessCompanyIndustry,jdbcType=VARCHAR},
			</if>
			<if test="businessCompanyAccount != null">
				businessCompanyAccount = #{businessCompanyAccount,jdbcType=INTEGER},
			</if>
			<if test="businessCompanyTax != null">
				businessCompanyTax = #{businessCompanyTax,jdbcType=INTEGER},
			</if>
			<if test="businessCompanyState != null">
				businessCompanyState = #{businessCompanyState,jdbcType=INTEGER},
			</if>
			<if test="businessCompanyCreatTime != null">
				businessCompanyCreatTime = #{businessCompanyCreatTime,jdbcType=VARCHAR},
			</if>
			<if test="businessCompanyBrowse != null">
				businessCompanyBrowse = #{businessCompanyBrowse,jdbcType=INTEGER},
			</if>
			<if test="businessCompany != null">
				businessCompany = #{businessCompany,jdbcType=INTEGER},
			</if>
			<if test="adminId != null">
				adminId = #{adminId,jdbcType=INTEGER},
			</if>
			<if test="businessCompanyTop != null">
				businessCompanyTop = #{businessCompanyTop,jdbcType=INTEGER},
			</if>
			
		</set>
		where businessCompanyId = #{businessCompanyId,jdbcType=INTEGER}
	</update>
	
	<!-- 根据id获取一条记录 -->
	<select id="findById" resultMap="BaseResultMap1">
	   select * from BusinessCompany where businessCompanyId=#{id}
	</select>
	<!-- 删除一条记录 -->
	<delete id="deletebusinessCompany">
	    delete from BusinessCompany where businessCompanyId=#{id}
	</delete>


	 <!--查询单个数据 -->	
	<select id="selectBusinessCompanys" resultMap="BaseResultMap" parameterType="Integer">
	    select * from BusinessCompany bc left join admin a  on bc.adminId = a.adminId  where businessCompanyId = #{businessCompanyId,jdbcType=INTEGER}
	</select>
	<!--增加浏览量  -->
	 <update id="updateViews"  parameterType="Integer" >
     	update BusinessCompany set businessCompanyBrowse = #{businessCompanyBrowse,jdbcType=INTEGER} 	where businessCompanyId = #{businessCompanyId,jdbcType=INTEGER}
     </update>
</mapper>

